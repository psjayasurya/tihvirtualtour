<!DOCTYPE html>
<html>
<head>
<title>Project Title</title>
<meta charset="utf-8">
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui" />
<style> @-ms-viewport { width: device-width; } </style>
<link rel="stylesheet" href="static/vendor/reset.min.css">
<link rel="stylesheet" href="static/style.css">
<link rel="stylesheet" href="static/styles2.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="static/dock.css">
</head>

<body class="multiple-scenes view-control-buttons">
<!-- Keep pano untouched -->
<div id="pano"></div>







<!-- âœ… Popup Window -->
<div id="projectPopup" class="popup-overlay">
  <div class="popup-content">
    <div class="popup-header">
      <h2 id="popupTitle">Ongoing Projects</h2>
      <button id="closePopup">âœ–</button>
    </div>
    <div class="popup-body" id="popupBody"></div>
  </div>
</div>













  <div class="curtain left"></div>
<div class="curtain right"></div>



   <div id="popupOverlay">
        <div id="popupContent">
            <h2>IIT Tirupati Navavishkar Innovation Hub</h2>
            <img src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/hub.jpg" alt="Hub Photo" style="width: 20%; height: 20%;" ><br>
             <button id="enterTourBtn">Welcome To TIH Virtual Tour</button>
        </div>
    </div>






<div id="header">
    <div class="logo-container">
        <img src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/geo-intel logo.jpeg" alt="IIT Tirupati Logo" style="width: 60%; height: 70%;" >
</div>

</div>

<audio id="bg-music" autoplay loop muted>
  <source src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/music/bgm.mpeg" type="audio/mpeg"> 
</audio>







<div id="sceneList">
  <ul class="scenes">
    
      <a href="javascript:void(0)" class="scene" data-id="0-near-lift">
        <li class="text">Lift Lobby</li>
      </a>
      <a href="javascript:void(0)" class="scene" data-id="1-entrance">
        <li class="text">Main Entrance </li>
      </a>

            <a href="javascript:void(0)" class="scene" data-id="0-meeting-room">
        <li class="text">Conference Room</li>
      </a>
    
    
      <a href="javascript:void(0)" class="scene" data-id="2-near-cafteria">
        <li class="text">Cafeteria Access</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="3-ceo-room">
        <li class="text">Near CEO Room</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="4-gnss-3">
        <li class="text">GNSS Lab </li>
      </a>
        <a href="javascript:void(0)" class="scene" data-id="0-cv-lab">
        <li class="text">Computer Vision Lab</li>
      </a>
      <a href="javascript:void(0)" class="scene" data-id="10-gis-lab">
        <li class="text">GIS Lab</li>
      </a>
      <a href="javascript:void(0)" class="scene" data-id="0-geo-intel">
        <li class="text">Geo - Intel Lab</li>
      </a>
      <a href="javascript:void(0)" class="scene" data-id="0-geo-intel-2">
        <li class="text">Geo - Intel Lab2</li>
      </a>




    
      <a href="javascript:void(0)" class="scene" data-id="5-computational-lab-outside">
        <li class="text">Computational Lab Outside</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="6-near-coffee-machine">
        <li class="text">Near Coffee Machine</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="7-near-project-director-room">
        <li class="text">Directorâ€™s Office Corridor</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="8-labs-outside">
        <li class="text">Research Labs (Exterior)</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="9-near-advisory-room">
        <li class="text">Advisory Room Corridor</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="11-gym-outside">
        <li class="text">Gym Corridor</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="12-gym">
        <li class="text">GYM</li>
      </a>
    
      <a href="javascript:void(0)" class="scene" data-id="13-gnss-2">
        <li class="text">GNSS Lab2</li>
      </a>
            <a href="javascript:void(0)" class="scene" data-id="1-geo-intel-21">
        <li class="text">Geo - Intel 2.1</li>
      </a>
    
  </ul>
</div>

<div id="titleBar">
  <h1 class="sceneName"></h1>
</div>

<a href="javascript:void(0)" id="autorotateToggle" >
  <img class="icon off" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/play.png">
  <img class="icon on" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/pause.png">
</a>

<a href="javascript:void(0)" id="fullscreenToggle">
  <img class="icon off" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/fullscreen.png">
  <img class="icon on" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/windowed.png">
</a>

<a href="javascript:void(0)" id="sceneListToggle">
  <img class="icon off" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/expand.png">
  <img class="icon on" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/collapse.png">
</a>

<a href="javascript:void(0)" id="viewUp" class="viewControlButton viewControlButton-1"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/up.png"></a>
<a href="javascript:void(0)" id="viewDown" class="viewControlButton viewControlButton-2"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/down.png"></a>
<a href="javascript:void(0)" id="viewLeft" class="viewControlButton viewControlButton-3"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/left.png"></a>
<a href="javascript:void(0)" id="viewRight" class="viewControlButton viewControlButton-4"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/right.png"></a>
<!--<a href="javascript:void(0)" id="viewIn" class="viewControlButton viewControlButton-5"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/plus.png"></a>
<a href="javascript:void(0)" id="viewOut" class="viewControlButton viewControlButton-6"><img class="icon" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/img/minus.png"></a>
-->
<script src="static/vendor/screenfull.min.js" ></script>
<script src="static/vendor/bowser.min.js" ></script>
<script src="static/vendor/marzipano.js" ></script>
<script src="http://10.26.70.96:5005/dataserver/data.js"></script>
<script src="static/index.js"></script>
<script src="static/project.js"></script>

<script>
  document.getElementById("enterTourBtn").addEventListener("click", function() {
    document.getElementById("popupOverlay").style.display = "none";
  });
</script>



<div id="floorMapContainer">
  <img id="floorMap" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/layout.png" alt="Floor Map">
  <div id="mapMarker"></div>
</div>

<!-- Popup Overlay for Large Map -->
<div id="floorMapOverlay">
  <img id="floorMapLarge" src="https://ggzftdlppjdrqugcrhgz.supabase.co/storage/v1/object/public/iittnifvirtualtour/images (1)/layout.png" alt="Large Floor Map">
</div>

<script>
  const floorMap = document.getElementById("floorMap");
  const overlay = document.getElementById("floorMapOverlay");
  const marker = document.getElementById("mapMarker");
 
  const floorMapContainer = document.getElementById("floorMapContainer");




  // Coordinates for each scene
  const panoPositions = {
    "1-entrance": { x: 322, y: 106 },
    "0-meeting-room": { x: 380, y: 211 },
    "2-near-cafteria": { x: 319, y: 181 },
    "3-ceo-room": { x: 319, y: 212 },
    "4-gnss-3": { x: 389, y: 239 },
    "5-computational-lab-outside": { x: 322, y: 298 },
    "6-near-coffee-machine": { x: 258, y: 283 },
    "7-near-project-director-room": { x: 220, y: 265 },
    "9-near-advisory-room": { x: 113, y: 271 },
    "10-gis-lab": { x: 121, y: 234 },
    "11-gym-outside": { x: 84, y: 253 },
    "12-gym": { x: 84, y: 228 },
    "13-gnss-2": { x: 357, y: 239 },
    "0-geo-intel": { x: 239, y: 244 },
    "0-geo-intel-2": { x: 189, y: 245 },
    "0-geo-intel-21": { x: 170, y: 227 },
    "0-cv-lab": { x: 149, y: 304},

  };

  // Move marker
  function moveMarker(sceneId) {
    const pos = panoPositions[sceneId];
    if (!pos) return;
    marker.style.left = pos.x + "px";
    marker.style.top = pos.y + "px";
  }

  // Detect scene change
  function onSceneChange(sceneId) {
    moveMarker(sceneId);
  }

  // Hook into switchScene
  const originalSwitchScene = switchScene;
  switchScene = function(scene) {
    originalSwitchScene(scene);
    onSceneChange(scene.data.id);
  };

  // Track yaw
  viewer.addEventListener('viewChange', function() {
    const yaw = view.yaw();
    marker.style.transform = `translate(-50%, -50%) rotate(${yaw}rad)`;
  });

  // Start marker at first scene
  if (scenes && scenes.length > 0) {
    moveMarker(scenes[0].data.id);
  }
</script>

<script>
  fetch("http://localhost:5000/hotspots")
  .then(response => response.json())
  .then(data => {
    APP_DATA.scenes.forEach(scene => {
      if (data[scene.id]) {
        scene.infoHotspots = data[scene.id];
      }
    });
    console.log("APP_DATA updated with DB values:", APP_DATA);
  })
  .catch(error => console.error("Error loading hotspots:", error));
</script>

<script> 


  APP_DATA.scenes.forEach(s => {
  if (s.infoHotspots) {
    s.infoHotspots.forEach(h => {
      const sceneObj = viewer.scene(); // or get scene by id
      addImageHotspot(sceneObj, h.yaw, h.pitch, 'hub.jpg', function() {
        alert(h.title + ": " + h.text);
      });
    });
  }
});


</script>

<!--<script>window.$zoho=window.$zoho || {};$zoho.salesiq=$zoho.salesiq||{ready:function(){}}</script><script id="zsiqscript" src="https://salesiq.zohopublic.com/widget?wc=siq649e2911aa06313dc69c245e9cf8df24" defer></script>-->

<script>



  window.addEventListener('load', () => {
    // Add open animation
    document.querySelector('.curtain.left').classList.add('open');
    document.querySelector('.curtain.right').classList.add('open');
    
    const curtainDuration = 900; // must match CSS transition time (2s)
    setTimeout(() => {
      document.getElementById("popupOverlay").style.display = "flex"; // or "grid", depending on layout
    }, curtainDuration + 100); // wait for animation + buffer
  });
  </script>









  <div id="dock-container"></div>
    <script src="static/dock.js"></script>
    <script>
        // Initialize the dock
        const dockItems = [
            { 
                icon: '<i class="fas fa-user"></i>', 
                label: 'Admin Panel', 
                onClick: () =>  window.location.href = 'http://10.26.90.239:5005/admin2' 
            },
            { 
                icon: '<i class="fa fa-building" aria-hidden="true"></i>', 
                label: 'IIT Tirupati 3D', 
                onClick: () => window.location.href = 'http://10.26.90.239:5007/' 
            },
            { 
                icon: '<i class="fa fa-television" aria-hidden="true"></i>', 
                label: 'Virtual Reality', 
                onClick: () => window.location.href = 'https://tihvr.wasmer.app/' 
            },
            {
                icon: '<i class="fa fa-music" aria-hidden="true"></i>',
                label: 'Music / Mute',
                onClick: () => {
                      const music = document.getElementById("bg-music");
                      music.volume = 0.5;

                      // If audio hasn't started yet, wait for user interaction to play
                      if (music.paused) {
                      document.body.addEventListener("click", function enableAudio() {
                      music.muted = false;
                      music.play();
                      document.body.removeEventListener("click", enableAudio);
                     });
                    }

                    // Toggle mute/unmute
                    if (music.muted) {
                        music.muted = false;
                        alert("ðŸ”Š Music Unmuted");
                    } else {
                        music.muted = true;
                        alert("ðŸ”‡ Music Muted");
                    }
                  }
            },
            
            { 
                icon: '<i class="fa fa-street-view" aria-hidden="true"></i>', 
                label: 'Show / Hide Floor Map', 
                onClick: () => {
                    const floorMap = document.getElementById("floorMap");
                    const overlay = document.getElementById("floorMapOverlay");
                            const marker = document.getElementById("mapMarker");
 
                              const floorMapContainer = document.getElementById("floorMapContainer");
                            floorMapContainer.classList.toggle("expanded");
      
                            // Click small map -> enlarge
                            floorMap.addEventListener("click", () => {
                              overlay.style.display = "flex";
                                        });
                                  // Click overlay -> close
                            overlay.addEventListener("click", () => {
                                 overlay.style.display = "none";
                                  });

      


                }
            },
            { 
                icon: '<i class="fa fa-location-arrow" aria-hidden="true"></i>', 
                label: 'Location', 
                onClick: () => window.open('https://maps.app.goo.gl/JmaZL3abYJG97hbH8', '_blank') 
            }
        ];

        const dock = new Dock('#dock-container', {
            items: dockItems,
            panelHeight: 68,
            baseItemSize: 50,
            magnification: 70,
            distance: 200,
            spring: {
                mass: 0.1,
                stiffness: 150,
                damping: 12
            }
        });
    </script>









</body>
</html>
